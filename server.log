
> rest-express@1.0.0 dev
> tsx watch server/index.ts

AuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:41:50.215593+00
Session table checked/created successfully
1:41:50 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
[API] GET /api/services - Query params: { partnerId: undefined, userCity: 'Tr√É¬™s Passos' }
[API] Buscando servi√ßos com filtro de localiza√ß√£o...
[getServicesWithLocationFilter] Iniciando busca de servi√ßos. userCity: Tr√É¬™s Passos maxDistance: 50
Session table checked/created successfully
[getServicesWithLocationFilter] Total de resultados encontrados: 12
[getServicesWithLocationFilter] Partner IDs √∫nicos: [
  12, 13, 4, 3,
   1,  5, 2
]
[getServicesWithLocationFilter] Mapeando servi√ßos...
[getServicesWithLocationFilter] Servi√ßos mapeados: 12
[getServicesWithLocationFilter] Filtrando servi√ßos por localiza√ß√£o...
[getServicesWithLocationFilter] Servi√ßos filtrados: 0
[API] Total de servi√ßos filtrados: 0
[API] Servi√ßos filtrados para cidade: Tr√É¬™s Passos
1:42:37 AM [tsx] change in ./server/utils/location-utils.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:42:38.826415+00
Session table checked/created successfully
1:42:39 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
1:42:46 AM [tsx] change in ./server/utils/location-utils.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:42:47.808041+00
Session table checked/created successfully
1:42:47 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
[API] GET /api/services - Query params: { partnerId: undefined, userCity: 'Tr√É¬™s Passos' }
[API] Buscando servi√ßos com filtro de localiza√ß√£o...
[getServicesWithLocationFilter] Iniciando busca de servi√ßos. userCity: Tr√É¬™s Passos maxDistance: 50
Session table checked/created successfully
[getServicesWithLocationFilter] Total de resultados encontrados: 12
[getServicesWithLocationFilter] Partner IDs √∫nicos: [
  12, 13, 4, 3,
   1,  5, 2
]
[getServicesWithLocationFilter] Mapeando servi√ßos...
[getServicesWithLocationFilter] Servi√ßos mapeados: 12
[getServicesWithLocationFilter] Filtrando servi√ßos por localiza√ß√£o...
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Crissiumal" -> Normalizada: "crissiumal"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Crissiumal" -> Normalizada: "crissiumal"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "Tres passos"
[getCityCoordinates] Cidade "Tres passos" n√£o encontrada nas coordenadas
[getCityCoordinates] Cidades dispon√≠veis: [ 'tres passos' ]
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getServicesWithLocationFilter] Servi√ßos filtrados: 0
[API] Total de servi√ßos filtrados: 0
[API] Servi√ßos filtrados para cidade: Tr√É¬™s Passos
1:43:41 AM [tsx] change in ./server/utils/location-utils.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:43:42.869872+00
Session table checked/created successfully
1:43:43 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
[API] GET /api/services - Query params: { partnerId: undefined, userCity: 'Tr√É¬™s Passos' }
[API] Buscando servi√ßos com filtro de localiza√ß√£o...
[getServicesWithLocationFilter] Iniciando busca de servi√ßos. userCity: Tr√É¬™s Passos maxDistance: 50
Session table checked/created successfully
[getServicesWithLocationFilter] Total de resultados encontrados: 12
[getServicesWithLocationFilter] Partner IDs √∫nicos: [
  12, 13, 4, 3,
   1,  5, 2
]
[getServicesWithLocationFilter] Mapeando servi√ßos...
[getServicesWithLocationFilter] Servi√ßos mapeados: 12
[getServicesWithLocationFilter] Filtrando servi√ßos por localiza√ß√£o...
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Crissiumal" -> Normalizada: "crissiumal"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Crissiumal" -> Normalizada: "crissiumal"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√É¬™s Passos" -> Normalizada: "tres passos"
[getCityCoordinates] Original: "Tr√™s Passos" -> Normalizada: "tres passos"
[getServicesWithLocationFilter] Servi√ßos filtrados: 8
[API] Total de servi√ßos filtrados: 8
[API] Servi√ßos filtrados para cidade: Tr√É¬™s Passos
[API] Exemplo de servi√ßo: {
  id: 6,
  name: 'Atendimento psicol√≥gico',
  isNational: false,
  distance: 0,
  serviceImage: 'Tem imagem',
  partner: 'Tem parceiro'
}
1:44:22 AM [tsx] change in ./server/utils/location-utils.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:44:24.233238+00
Session table checked/created successfully
1:44:24 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
1:45:04 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:45:05.43596+00
Session table checked/created successfully
1:45:05 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
1:45:22 AM [tsx] change in ./server/routes/index.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:45:23.531036+00
Session table checked/created successfully
1:45:23 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
Session table checked/created successfully
[getServicesWithLocationFilter] Erro geral na fun√ß√£o: error: column partners.profile_image does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/src/neon-serverless/session.ts:61:18)
    at async DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1401:23)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26) {
  length: 121,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '918',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3716',
  routine: 'errorMissingColumn'
}
Erro ao buscar servi√ßos: Error: Erro ao buscar servi√ßos: column partners.profile_image does not exist
    at DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1530:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26)
1:46:08 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:46:09.517099+00
Session table checked/created successfully
1:46:09 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
1:46:24 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:46:25.737666+00
Session table checked/created successfully
1:46:25 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
Session table checked/created successfully
[getServicesWithLocationFilter] Erro geral na fun√ß√£o: error: column partners.profile_image does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/src/neon-serverless/session.ts:61:18)
    at async DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1401:23)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26) {
  length: 121,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '918',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3716',
  routine: 'errorMissingColumn'
}
Erro ao buscar servi√ßos: Error: Erro ao buscar servi√ßos: column partners.profile_image does not exist
    at DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1526:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26)
1:47:30 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:47:31.245321+00
Session table checked/created successfully
1:47:31 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
Session table checked/created successfully
[getServicesWithLocationFilter] Erro geral na fun√ß√£o: error: column "profile_image" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/src/neon-serverless/session.ts:61:18)
    at async DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1412:30)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26) {
  length: 114,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '222',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '3716',
  routine: 'errorMissingColumn'
}
Erro ao buscar servi√ßos: Error: Erro ao buscar servi√ßos: column "profile_image" does not exist
    at DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1520:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26)
1:47:57 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:47:58.123292+00
Session table checked/created successfully
1:47:58 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
Session table checked/created successfully
[getServicesWithLocationFilter] Erro geral na fun√ß√£o: error: invalid input syntax for type integer: "12,13,4,3,1,5,2"
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async NeonPreparedQuery.execute (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/src/neon-serverless/session.ts:61:18)
    at async DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1412:30)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26) {
  length: 158,
  severity: 'ERROR',
  code: '22P02',
  detail: undefined,
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: "unnamed portal parameter $1 = '...'",
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'numutils.c',
  line: '616',
  routine: 'pg_strtoint32_safe'
}
Erro ao buscar servi√ßos: Error: Erro ao buscar servi√ßos: invalid input syntax for type integer: "12,13,4,3,1,5,2"
    at DatabaseStorage.getServicesWithLocationFilter (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/storage.ts:1543:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:182:26)
1:48:32 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:48:33.690637+00
Session table checked/created successfully
1:48:33 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
1:48:37 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 04:48:38.900943+00
Session table checked/created successfully
1:48:39 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
Session table checked/created successfully
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîç Middleware JWT Global - Processando: /api/subscription/current
üîç Cookies: {
  __stripe_mid: '1861aef6-543f-4483-ab4b-09818dff49e4c5183e',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NDIzNzk3LCJleHAiOjE3NTAwMjg1OTd9.etqRBoYdkIPLS5kwKiqUgwNtgw9hLmU8KLwGC2lTe34',
  __stripe_sid: '7c40b497-1ceb-4182-820a-71f532e8cd44f0b120'
}
üîç Headers auth: undefined
üîç Header x-auth-token: undefined
üîç Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
üîç Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749423797,
  exp: 1750028597
}
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profiles/profile-1749872528273-906009943.jpg
üîÑ Redirecionando para imagem padr√£o: /profiles/profile-1749872528273-906009943.jpg
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /unread-count
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîç Notifications /unread-count - Buscando contagem para usu√°rio ID: 58
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Final do middleware - Usu√°rio autenticado? true
Verificando autentica√ß√£o na rota de assinatura...
‚úÖ Usu√°rio autenticado: lucas.canova@hotmail.com
üîç Buscando assinatura atual para usu√°rio lucas.canova@hotmail.com (ID: 58)
‚úÖ Notifications /unread-count - Contagem: 2
‚úÖ Assinatura encontrada:
   - ID: 1
   - Status: active
   - Plano: ultra_family
   - Data cria√ß√£o: Sun Jun 08 2025 20:10:30 GMT-0300 (Brasilia Standard Time)
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /recent-activities
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîç Activities - Buscando atividades recentes do usu√°rio ID: 58
Encontradas 1 consultas pr√≥ximas
‚úÖ Activities - Atividades encontradas: 9
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profile-1747876767178-948110885.jpg
üîÑ Redirecionando para imagem padr√£o: /profile-1747876767178-948110885.jpg
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profile-1747951137232-694756185.jpg
üîÑ Redirecionando para imagem padr√£o: /profile-1747951137232-694756185.jpg
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para POST /108/cancel
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Cancelando consulta #108 pelo usu√°rio 58
Verificando permiss√£o de cancelamento - Paciente userId: 58, appointment.userId: 58
Consulta #108 cancelada com sucesso
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Encontradas 1 consultas pr√≥ximas
10:22:57 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 13:22:58.959211+00
Session table checked/created successfully
10:22:59 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
10:23:04 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 13:23:06.211542+00
Session table checked/created successfully
10:23:06 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
10:30:24 AM [tsx] change in ./server/storage.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 13:30:26.805528+00
Session table checked/created successfully
10:30:27 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
10:35:29 AM [tsx] change in ./server/routes/appointment-join.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 13:35:31.514709+00
Session table checked/created successfully
10:35:31 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
10:36:02 AM [tsx] change in ./server/routes/appointment-join.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 13:36:04.022273+00
Session table checked/created successfully
10:36:04 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
üîê requireAuth - Verificando autentica√ß√£o para GET /debug/108
üîê requireAuth - req.user: undefined
‚ùå requireAuth - Usu√°rio n√£o autenticado para GET /debug/108
11:16:28 AM [tsx] change in ./server/routes/appointment-join.ts Restarting...
cAuthRouter carregado - rotas dispon√≠veis:
- POST /register
- POST /login
- POST /test
- GET /user (verifica√ß√£o de autentica√ß√£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
üñºÔ∏è Configurando diret√≥rio de arquivos est√°ticos...
‚úÖ Arquivos est√°ticos servidos de: /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/public
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas p√∫blicas de m√©dicos em /api/doctors
Registrando rotas p√∫blicas de servi√ßos em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Registrando chatRouter em /api/chat
Conex√£o com o banco de dados testada com sucesso: 2025-06-14 14:16:30.027979+00
Session table checked/created successfully
11:16:30 AM [server] Servidor rodando na porta 8080
Acesse: http://localhost:8080
Ou: http://127.0.0.1:8080
üïê Configurando jobs agendados...
‚ö†Ô∏è node-cron n√£o est√° instalado. Jobs agendados desabilitados.
Para habilitar, execute: npm install node-cron
Configura√ß√£o de email carregada. Servi√ßo de email dispon√≠vel.
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando claims para usu√°rio 58
Encontrados 0 claims
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profile-1747876767178-948110885.jpg
üîÑ Redirecionando para imagem padr√£o: /profile-1747876767178-948110885.jpg
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profile-1747951137232-694756185.jpg
üîÑ Redirecionando para imagem padr√£o: /profile-1747951137232-694756185.jpg
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-14
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-14
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-15
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 6
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-16
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 0
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-17
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-17
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-18
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-18
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-19
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-19
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-20
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-20
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-21
‚úÖ Doctor /:id/availability - 2 hor√°rios dispon√≠veis para 2025-06-21
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-22
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 6
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-23
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 0
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-24
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-24
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-25
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-25
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-26
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-26
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-27
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-27
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para POST /
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para POST /
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /unread-count
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîç Notifications /unread-count - Buscando contagem para usu√°rio ID: 58
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
‚úÖ Notifications /unread-count - Contagem: 2
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚ö†Ô∏è Arquivo de upload n√£o encontrado: /profiles/profile-1749872528273-906009943.jpg
üîÑ Redirecionando para imagem padr√£o: /profiles/profile-1749872528273-906009943.jpg
Total de consultas encontradas para usu√°rio 58: 6
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Session table checked/created successfully
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç M√©dico selecionado para emerg√™ncia: {
  doctorId: 4,
  doctorUserId: 32,
  doctorName: 'Lucas Dickel Canova',
  availableForEmergency: true
}
üöÄ Criando sala de emerg√™ncia: emergency-58-1749911912354
‚û°Ô∏è Criando sala emergency-58-1749911912354 no Daily.co - API key: true
üîç Verificando se sala "emergency-58-1749911912354" j√° existe...
Sala "emergency-58-1749911912354" n√£o existe, ser√° criada
üÜï Criando nova sala "emergency-58-1749911912354" no Daily.co...
Payload para cria√ß√£o da sala: {"name":"emergency-58-1749911912354","properties":{"start_audio_off":false,"start_video_off":false,"enable_chat":true,"enable_screenshare":true,"enable_knocking":false,"enable_network_ui":true,"enable_prejoin_ui":false,"exp":1749915513}}
‚úÖ Sala "emergency-58-1749911912354" criada com sucesso
‚è≥ Aguardando primeira fase de propaga√ß√£o (5s)...
üîç Verificando se sala "emergency-58-1749911912354" j√° est√° acess√≠vel...
‚úÖ Sala "emergency-58-1749911912354" confirmada como acess√≠vel
‚è≥ Aguardando propaga√ß√£o adicional da sala...
Criando token para sala emergency-58-1749911912354
Verificando/criando sala emergency-58-1749911912354 antes de gerar token
‚û°Ô∏è Criando sala emergency-58-1749911912354 no Daily.co - API key: true
üîç Verificando se sala "emergency-58-1749911912354" j√° existe...
‚úÖ Sala "emergency-58-1749911912354" j√° existe no Daily.co
Sala emergency-58-1749911912354 verificada/criada com sucesso
Solicitando token com propriedades: {
  room_name: 'emergency-58-1749911912354',
  user_id: '58',
  user_name: 'Lucas Dickel Canova',
  exp: 1749919122,
  is_owner: false,
  enable_screenshare: true,
  start_video_off: false,
  start_audio_off: false
}
Token simplificado criado com sucesso: eyJhbGciOiJIUzI...
‚úÖ Consulta de emerg√™ncia criada: {
  appointmentId: 113,
  doctorId: 4,
  userId: 58,
  status: 'waiting',
  isEmergency: true,
  type: 'telemedicine'
}
Consulta de emerg√™ncia iniciada: Paciente Lucas Dickel Canova (ID: 58) com Dr. Lucas Dickel Canova (ID: 4), Sala: emergency-58-1749911912354
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üìã Consulta de emerg√™ncia 113 consultada por paciente 58
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /upcoming
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
Buscando consultas pr√≥ximas para usu√°rio 58
Total de consultas encontradas para usu√°rio 58: 7
Consulta ID: 107, Status: waiting, Date: 2025-06-13T22:28:18.014Z
Consulta ID: 109, Status: waiting, Date: 2025-06-14T03:52:32.964Z
Consulta ID: 110, Status: waiting, Date: 2025-06-14T03:53:19.495Z
Consulta ID: 108, Status: cancelled, Date: 2025-06-20T20:30:00.000Z
Consulta ID: 111, Status: waiting, Date: 2025-06-14T04:30:10.704Z
Consulta ID: 113, Status: waiting, Date: 2025-06-14T14:38:42.478Z
Consulta ID: 112, Status: waiting, Date: 2025-06-14T13:21:19.557Z
Consultas ap√≥s filtrar canceladas: 0
Encontradas 0 consultas pr√≥ximas
Consultas retornadas: []
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-14
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-14
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-15
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 6
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-16
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 0
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-17
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-17
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-18
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-18
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-19
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-19
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-20
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-20
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-21
‚úÖ Doctor /:id/availability - 2 hor√°rios dispon√≠veis para 2025-06-21
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-22
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 6
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-23
‚ÑπÔ∏è Doctor /:id/availability - Nenhum slot dispon√≠vel para o dia 0
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-24
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-24
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-25
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-25
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-26
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-26
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Doctor /:id/availability - Buscando disponibilidade do m√©dico ID: 4 para data: 2025-06-27
‚úÖ Doctor /:id/availability - 3 hor√°rios dispon√≠veis para 2025-06-27
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
Erro ao criar inten√ß√£o de pagamento para consulta: AppError: Voc√™ precisa ter um m√©todo de pagamento cadastrado para realizar consultas
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/consultation-payment-routes.ts:53:13)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at requireAuth (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/consultation-payment-routes.ts:23:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12) {
  statusCode: 400,
  status: 'fail',
  isOperational: true
}
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /profile
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
üîç Middleware JWT Global - Processando: /api/subscription/current
üîç Cookies: {
  __stripe_mid: '1861aef6-543f-4483-ab4b-09818dff49e4c5183e',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NDIzNzk3LCJleHAiOjE3NTAwMjg1OTd9.etqRBoYdkIPLS5kwKiqUgwNtgw9hLmU8KLwGC2lTe34',
  __stripe_sid: 'eef2774e-af26-49a7-811a-5102c64c468cf2c09d'
}
üîç Headers auth: undefined
üîç Header x-auth-token: undefined
üîç Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
üîç Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749423797,
  exp: 1750028597
}
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîç Final do middleware - Usu√°rio autenticado? true
Verificando autentica√ß√£o na rota de assinatura...
‚úÖ Usu√°rio autenticado: lucas.canova@hotmail.com
üîç Buscando assinatura atual para usu√°rio lucas.canova@hotmail.com (ID: 58)
‚úÖ Assinatura encontrada:
   - ID: 1
   - Status: active
   - Plano: ultra_family
   - Data cria√ß√£o: Sun Jun 08 2025 20:10:30 GMT-0300 (Brasilia Standard Time)
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
üîê requireAuth - Verificando autentica√ß√£o para GET /recent-activities
üîê requireAuth - req.user: 58 (patient)
‚úÖ requireAuth - Usu√°rio autenticado: 58 (patient)
üîç Activities - Buscando atividades recentes do usu√°rio ID: 58
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
‚úÖ Activities - Atividades encontradas: 9
üîê JWT: Usu√°rio lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
