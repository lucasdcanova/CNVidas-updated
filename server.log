
> rest-express@1.0.0 start
> NODE_ENV=production node dist/server/index.js

AuthRouter carregado - rotas disponÃ­veis:
- POST /register
- POST /login
- POST /test
- GET /user (verificaÃ§Ã£o de autenticaÃ§Ã£o)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando rotas pÃºblicas de mÃ©dicos em /api/doctors
Registrando rotas pÃºblicas de serviÃ§os em /api/services
ğŸ” Tentando servir arquivos estÃ¡ticos de: /Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/client
ğŸ” Ou de: /Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/dist/client
âœ… Usando diretÃ³rio public compilado
10:48:05 PM [server] Servidor rodando na porta 3000
ConexÃ£o com o banco de dados testada com sucesso: 2025-06-10 01:48:06.851623+00
Session table checked/created successfully
ConfiguraÃ§Ã£o de email carregada. ServiÃ§o de email disponÃ­vel.
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via header
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'Lucas Canova',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    'content-type': 'application/json',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAwOTV9.xaR5vIlLCJvLZb9M-pjwJF_Nn_jWUO06Vv8m6fNjYhs',
    'x-auth-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAwOTV9.xaR5vIlLCJvLZb9M-pjwJF_Nn_jWUO06Vv8m6fNjYhs',
    accept: '*/*',
    'user-agent': 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)',
    'accept-encoding': 'gzip,deflate',
    host: 'localhost:3000',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 0
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via header
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'Lucas Canova',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    'content-type': 'application/json',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAxMTh9.rwogr1jBHZPe7X9YawSpgkf_lKX95YKW44Mq5X3jCdo',
    'x-auth-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAxMTh9.rwogr1jBHZPe7X9YawSpgkf_lKX95YKW44Mq5X3jCdo',
    accept: '*/*',
    'user-agent': 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)',
    'accept-encoding': 'gzip,deflate',
    host: 'localhost:3000',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 0
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via header
POST /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'Lucas Canova',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  body: {
    fullName: 'JoÃ£o da Silva',
    cpf: '12345678901',
    birthDate: '2010-05-15',
    relationship: 'filho'
  },
  headers: {
    'content-type': 'application/json',
    authorization: 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAxMTh9.rwogr1jBHZPe7X9YawSpgkf_lKX95YKW44Mq5X3jCdo',
    'x-auth-token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiZnVsbE5hbWUiOiJMdWNhcyBDYW5vdmEiLCJpYXQiOjE3NDk1MjAxMTh9.rwogr1jBHZPe7X9YawSpgkf_lKX95YKW44Mq5X3jCdo',
    accept: '*/*',
    'content-length': '97',
    'user-agent': 'node-fetch/1.0 (+https://github.com/bitinn/node-fetch)',
    'accept-encoding': 'gzip,deflate',
    host: 'localhost:3000',
    connection: 'keep-alive'
  }
}
Dados recebidos: {
  fullName: 'JoÃ£o da Silva',
  birthDate: '2010-05-15',
  relationship: 'filho',
  cpf: '12345678901'
}
Data formatada: 2010-05-15
Inserindo dependente com dados: {
  userId: 58,
  fullName: 'JoÃ£o da Silva',
  cpf: '12345678901',
  birthDate: '2010-05-15',
  relationship: 'filho'
}
Dependente criado com sucesso: {
  id: 5,
  userId: 58,
  fullName: 'JoÃ£o da Silva',
  cpf: '12345678901',
  birthDate: '2010-05-15',
  relationship: 'filho',
  createdAt: 2025-06-10T01:48:39.346Z,
  updatedAt: 2025-06-10T01:48:39.346Z
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications /unread-count - Contagem: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'lucas.canova@hotmail.com',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    host: 'localhost:3000',
    accept: '*/*',
    'cache-control': 'no-cache, no-store, must-revalidate',
    pragma: 'no-cache',
    'sec-fetch-site': 'same-origin',
    'sec-fetch-mode': 'cors',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15',
    referer: 'http://localhost:3000/dependents',
    expires: '0',
    'sec-fetch-dest': 'empty',
    'accept-language': 'pt-BR,pt;q=0.9',
    priority: 'u=3, i',
    'accept-encoding': 'gzip, deflate',
    cookie: '__stripe_mid=b68fb7b5-7729-457a-8c4f-5950aef53585a80166; auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTE4MTQ2LCJleHAiOjE3NTAxMjI5NDZ9.Jilgs_ev60DFEJojiuWWNGsd-HbfUh0HQ6C-m6zRkfQ',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
POST /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'lucas.canova@hotmail.com',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  body: {
    fullName: 'Luiz Eugenio Canova',
    cpf: '25628704091',
    relationship: 'filho',
    birthDate: '1956-03-23'
  },
  headers: {
    host: 'localhost:3000',
    'content-type': 'application/json',
    pragma: 'no-cache',
    accept: '*/*',
    'sec-fetch-site': 'same-origin',
    expires: '0',
    'cache-control': 'no-cache, no-store, must-revalidate',
    'sec-fetch-mode': 'cors',
    origin: 'http://localhost:3000',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15',
    referer: 'http://localhost:3000/dependents',
    'content-length': '102',
    'sec-fetch-dest': 'empty',
    'accept-language': 'pt-BR,pt;q=0.9',
    priority: 'u=3, i',
    'accept-encoding': 'gzip, deflate',
    cookie: '__stripe_mid=b68fb7b5-7729-457a-8c4f-5950aef53585a80166; __stripe_sid=75c29ae6-8447-47f7-846e-7b7f9a89cf8f4d3de9; auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTE4MTQ2LCJleHAiOjE3NTAxMjI5NDZ9.Jilgs_ev60DFEJojiuWWNGsd-HbfUh0HQ6C-m6zRkfQ',
    connection: 'keep-alive'
  }
}
Dados recebidos: {
  fullName: 'Luiz Eugenio Canova',
  birthDate: '1956-03-23',
  relationship: 'filho',
  cpf: '25628704091'
}
Data formatada: 1956-03-23
Inserindo dependente com dados: {
  userId: 58,
  fullName: 'Luiz Eugenio Canova',
  cpf: '25628704091',
  birthDate: '1956-03-23',
  relationship: 'filho'
}
Dependente criado com sucesso: {
  id: 6,
  userId: 58,
  fullName: 'Luiz Eugenio Canova',
  cpf: '25628704091',
  birthDate: '1956-03-23',
  relationship: 'filho',
  createdAt: 2025-06-10T02:02:34.972Z,
  updatedAt: 2025-06-10T02:02:34.972Z
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'lucas.canova@hotmail.com',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    host: 'localhost:3000',
    accept: '*/*',
    'cache-control': 'no-cache, no-store, must-revalidate',
    pragma: 'no-cache',
    'sec-fetch-site': 'same-origin',
    'sec-fetch-mode': 'cors',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15',
    referer: 'http://localhost:3000/dependents',
    expires: '0',
    'sec-fetch-dest': 'empty',
    'accept-language': 'pt-BR,pt;q=0.9',
    priority: 'u=3, i',
    'accept-encoding': 'gzip, deflate',
    cookie: '__stripe_mid=b68fb7b5-7729-457a-8c4f-5950aef53585a80166; __stripe_sid=75c29ae6-8447-47f7-846e-7b7f9a89cf8f4d3de9; auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTE4MTQ2LCJleHAiOjE3NTAxMjI5NDZ9.Jilgs_ev60DFEJojiuWWNGsd-HbfUh0HQ6C-m6zRkfQ',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 2
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: 'b68fb7b5-7729-457a-8c4f-5950aef53585a80166',
  __stripe_sid: '75c29ae6-8447-47f7-846e-7b7f9a89cf8f4d3de9',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTE4MTQ2LCJleHAiOjE3NTAxMjI5NDZ9.Jilgs_ev60DFEJojiuWWNGsd-HbfUh0HQ6C-m6zRkfQ'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749518146,
  exp: 1750122946
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
Logout realizado com sucesso - cookies removidos
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/login INTERCEPTADA ===
=== ROTA LOGIN CHAMADA ===
URL: /login
Method: POST
Body: { email: 'lucas.canova@icloud.com', password: 'qweasdzxc123' }
Buscando usuÃ¡rio no banco: lucas.canova@icloud.com
UsuÃ¡rio encontrado: true
Login bem-sucedido para: lucas.canova@icloud.com
Cookie options: {
  host: 'localhost:3000',
  isLocalhost: true,
  isProduction: true,
  secure: false,
  domain: undefined
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 1
âœ… Notifications /unread-count - Contagem: 2
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 2
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Middleware JWT Global - Processando: /api/admin/claims
ğŸ” Cookies: {
  __stripe_mid: 'dbc28879-51e6-478a-ba65-8d9bffb77cd45a9ef8',
  __stripe_sid: '6f63a2e1-c879-4198-8f2e-c65b5f1942af1a1a86',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoibHVjYXMuY2Fub3ZhQGljbG91ZC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDk1MjEwMDEsImV4cCI6MTc1MDEyNTgwMX0.GWUbuyqSGWDDpOBgBlGwIL2xvCNBDsPG5syocWvvgsw'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Middleware JWT Global - Processando: /api/admin/pending-claims
ğŸ” Cookies: {
  __stripe_mid: 'dbc28879-51e6-478a-ba65-8d9bffb77cd45a9ef8',
  __stripe_sid: '6f63a2e1-c879-4198-8f2e-c65b5f1942af1a1a86',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoibHVjYXMuY2Fub3ZhQGljbG91ZC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDk1MjEwMDEsImV4cCI6MTc1MDEyNTgwMX0.GWUbuyqSGWDDpOBgBlGwIL2xvCNBDsPG5syocWvvgsw'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
âœ… Notifications /unread-count - Contagem: 2
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” Middleware JWT Global - Processando: /api/admin/users
ğŸ” Cookies: {
  __stripe_mid: 'dbc28879-51e6-478a-ba65-8d9bffb77cd45a9ef8',
  __stripe_sid: '6f63a2e1-c879-4198-8f2e-c65b5f1942af1a1a86',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsImVtYWlsIjoibHVjYXMuY2Fub3ZhQGljbG91ZC5jb20iLCJyb2xlIjoiYWRtaW4iLCJpYXQiOjE3NDk1MjEwMDEsImV4cCI6MTc1MDEyNTgwMX0.GWUbuyqSGWDDpOBgBlGwIL2xvCNBDsPG5syocWvvgsw'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@icloud.com autenticado via cookie
Logout realizado com sucesso - cookies removidos
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/login INTERCEPTADA ===
=== ROTA LOGIN CHAMADA ===
URL: /login
Method: POST
Body: { email: 'lucas.canova@hotmail.com', password: 'qweasdzxc123' }
Buscando usuÃ¡rio no banco: lucas.canova@hotmail.com
UsuÃ¡rio encontrado: true
Login bem-sucedido para: lucas.canova@hotmail.com
Cookie options: {
  host: 'localhost:3000',
  isLocalhost: true,
  isProduction: true,
  secure: false,
  domain: undefined
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications /unread-count - Contagem: 1
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'lucas.canova@hotmail.com',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    host: 'localhost:3000',
    accept: '*/*',
    'cache-control': 'no-cache, no-store, must-revalidate',
    pragma: 'no-cache',
    'sec-fetch-site': 'same-origin',
    'sec-fetch-mode': 'cors',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15',
    referer: 'http://localhost:3000/dependents',
    expires: '0',
    'sec-fetch-dest': 'empty',
    'accept-language': 'pt-BR,pt;q=0.9',
    priority: 'u=3, i',
    'accept-encoding': 'gzip, deflate',
    cookie: '__stripe_mid=1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce; __stripe_sid=25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db; auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 2
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
Retornando planos de assinatura para usuÃ¡rio (rota pÃºblica): [
  {
    id: 4,
    name: 'free',
    displayName: 'Gratuito',
    price: 0,
    emergencyConsultations: '0',
    specialistDiscount: 0,
    insuranceCoverage: false,
    features: [
      'Acesso ao marketplace',
      'Pagamento integral pelos serviÃ§os',
      '0 teleconsultas de emergÃªncia por mÃªs',
      'Sem descontos e sem cobertura de seguro'
    ],
    isDefault: true,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 5,
    name: 'basic',
    displayName: 'BÃ¡sico',
    price: 8990,
    emergencyConsultations: '2',
    specialistDiscount: 30,
    insuranceCoverage: true,
    features: [
      '2 teleconsultas de emergÃªncia por mÃªs',
      '30% de desconto com especialistas',
      'Acesso completo aos descontos de parceiros',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 6,
    name: 'premium',
    displayName: 'Premium',
    price: 12990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 50,
    insuranceCoverage: true,
    features: [
      'Teleconsultas de emergÃªncia ilimitadas',
      '50% de desconto com especialistas',
      'Prioridade de agendamento',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte prioritÃ¡rio 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 7,
    name: 'basic_family',
    displayName: 'BÃ¡sico Familiar',
    price: 14990,
    emergencyConsultations: '2',
    specialistDiscount: 30,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do BÃ¡sico para cada dependente',
      'AtÃ© 4 CPFs',
      '2 teleconsultas de emergÃªncia por mÃªs',
      '30% de desconto com especialistas',
      'Acesso completo aos descontos de parceiros',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 8,
    name: 'premium_family',
    displayName: 'Premium Familiar',
    price: 19990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 50,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Premium para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '50% de desconto com especialistas',
      'Prioridade de agendamento',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte prioritÃ¡rio 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 9,
    name: 'ultra',
    displayName: 'Ultra',
    price: 16990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
]
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce',
  __stripe_sid: '25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
Retornando planos de assinatura para usuÃ¡rio (rota pÃºblica): [
  {
    id: 4,
    name: 'free',
    displayName: 'Gratuito',
    price: 0,
    emergencyConsultations: '0',
    specialistDiscount: 0,
    insuranceCoverage: false,
    features: [
      'Acesso ao marketplace',
      'Pagamento integral pelos serviÃ§os',
      '0 teleconsultas de emergÃªncia por mÃªs',
      'Sem descontos e sem cobertura de seguro'
    ],
    isDefault: true,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 5,
    name: 'basic',
    displayName: 'BÃ¡sico',
    price: 8990,
    emergencyConsultations: '2',
    specialistDiscount: 30,
    insuranceCoverage: true,
    features: [
      '2 teleconsultas de emergÃªncia por mÃªs',
      '30% de desconto com especialistas',
      'Acesso completo aos descontos de parceiros',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 6,
    name: 'premium',
    displayName: 'Premium',
    price: 12990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 50,
    insuranceCoverage: true,
    features: [
      'Teleconsultas de emergÃªncia ilimitadas',
      '50% de desconto com especialistas',
      'Prioridade de agendamento',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte prioritÃ¡rio 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-19T14:54:18.234Z,
    updatedAt: 2025-05-19T14:54:18.234Z
  },
  {
    id: 7,
    name: 'basic_family',
    displayName: 'BÃ¡sico Familiar',
    price: 14990,
    emergencyConsultations: '2',
    specialistDiscount: 30,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do BÃ¡sico para cada dependente',
      'AtÃ© 4 CPFs',
      '2 teleconsultas de emergÃªncia por mÃªs',
      '30% de desconto com especialistas',
      'Acesso completo aos descontos de parceiros',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 8,
    name: 'premium_family',
    displayName: 'Premium Familiar',
    price: 19990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 50,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Premium para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '50% de desconto com especialistas',
      'Prioridade de agendamento',
      'Cobertura de seguro: R$ 300/dia de internaÃ§Ã£o',
      'Suporte prioritÃ¡rio 24/7'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 9,
    name: 'ultra',
    displayName: 'Ultra',
    price: 16990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  },
  {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
]
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce',
  __stripe_sid: '25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce',
  __stripe_sid: '25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
GET /api/dependents - Request received: {
  user: {
    id: 58,
    email: 'lucas.canova@hotmail.com',
    role: 'patient',
    fullName: 'lucas.canova@hotmail.com',
    username: 'lucas.canova@hotmail.com',
    emailVerified: true
  },
  url: '/',
  headers: {
    host: 'localhost:3000',
    accept: '*/*',
    'cache-control': 'no-cache, no-store, must-revalidate',
    pragma: 'no-cache',
    'sec-fetch-site': 'same-origin',
    'sec-fetch-mode': 'cors',
    'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15',
    referer: 'http://localhost:3000/dependents',
    expires: '0',
    'sec-fetch-dest': 'empty',
    'accept-language': 'pt-BR,pt;q=0.9',
    priority: 'u=3, i',
    'accept-encoding': 'gzip, deflate',
    cookie: '__stripe_mid=1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce; __stripe_sid=25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db; auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU',
    connection: 'keep-alive'
  }
}
Buscando dependentes para usuÃ¡rio ID: 58
Dependentes encontrados: 2
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce',
  __stripe_sid: '25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '1eed2316-8777-4bfe-a372-d2355fcc1886fcb2ce',
  __stripe_sid: '25266ae5-8830-4fd3-bc94-f4ab1dd9b65c1d33db',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIxMTEzLCJleHAiOjE3NTAxMjU5MTN9.KYMjgKUitEddEopPKfeyc5EnFnhqDy2PPQH9_6fsWiU'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749521113,
  exp: 1750125913
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/login INTERCEPTADA ===
=== ROTA LOGIN CHAMADA ===
URL: /login
Method: POST
Body: { email: 'lucas.canova@hotmail.com', password: 'qweasdzxc123' }
Buscando usuÃ¡rio no banco: lucas.canova@hotmail.com
UsuÃ¡rio encontrado: true
Login bem-sucedido para: lucas.canova@hotmail.com
Cookie options: {
  host: 'localhost:3000',
  isLocalhost: true,
  isProduction: true,
  secure: false,
  domain: undefined
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
=== ROTA /api/user INTERCEPTADA ===
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
âœ… Notifications /unread-count - Contagem: 1
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications /unread-count - Buscando contagem para usuÃ¡rio ID: 58
ğŸ” Middleware JWT Global - Processando: /api/subscription/current
ğŸ” Cookies: {
  __stripe_mid: '22a2b8e1-cca1-4b49-8331-fb56dcc47a4bd0eb35',
  __stripe_sid: '96014081-9d2d-4a76-a397-b6990e70c4c3a42051',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NTIyNjg3LCJleHAiOjE3NTAxMjc0ODd9.qH8QK3MkUoJ0EczNDaJENuVsq07WwaXnN1ljC5eMD0Y'
}
ğŸ” Headers auth: undefined
ğŸ” Header x-auth-token: undefined
ğŸ” Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
ğŸ” Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749522687,
  exp: 1750127487
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Final do middleware - UsuÃ¡rio autenticado? true
Verificando autenticaÃ§Ã£o na rota de assinatura...
âœ… UsuÃ¡rio autenticado: lucas.canova@hotmail.com
ğŸ” Buscando assinatura atual para usuÃ¡rio lucas.canova@hotmail.com (ID: 58)
âœ… Notifications /unread-count - Contagem: 1
âœ… Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefÃ­cios do Ultra para cada dependente',
      'AtÃ© 4 CPFs',
      'Teleconsultas de emergÃªncia ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade mÃ¡xima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internaÃ§Ã£o',
      'Todos os demais benefÃ­cios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
ğŸ” Notifications - Buscando notificaÃ§Ãµes do usuÃ¡rio ID: 58
ğŸ” JWT: UsuÃ¡rio lucas.canova@hotmail.com autenticado via cookie
âœ… Notifications - NotificaÃ§Ãµes encontradas: 1
