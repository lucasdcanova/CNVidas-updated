
> rest-express@1.0.0 dev
> tsx watch server/index.ts

AuthRouter carregado - rotas disponíveis:
- POST /register
- POST /login
- POST /test
- GET /user (verificação de autenticação)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas públicas de médicos em /api/doctors
Registrando rotas públicas de serviços em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Conexão com o banco de dados testada com sucesso: 2025-06-11 16:14:32.899187+00
Session table checked/created successfully
1:14:34 PM [server] Servidor rodando na porta 3000
Configuração de email carregada. Serviço de email disponível.
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
🔍 Middleware JWT Global - Processando: /api/subscription/current
🔍 Cookies: {
  __stripe_mid: 'bdc1666f-9474-4caa-ae76-431be93669eee68999',
  __stripe_sid: '13bd9441-f8ae-456f-a4d8-634dfbe1b3cd62287c',
  auth_token: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjU4LCJlbWFpbCI6Imx1Y2FzLmNhbm92YUBob3RtYWlsLmNvbSIsInJvbGUiOiJwYXRpZW50IiwiaWF0IjoxNzQ5NjA2MjIzLCJleHAiOjE3NTAyMTEwMjN9.wnJIKSYJygjP291yS8vSLiLQmKeTUQOLao_T5HWK0fE'
}
🔍 Headers auth: undefined
🔍 Header x-auth-token: undefined
🔍 Verificando cookie auth_token: eyJhbGciOiJIUzI1NiIs...
🔍 Cookie decodificado: {
  userId: 58,
  email: 'lucas.canova@hotmail.com',
  role: 'patient',
  iat: 1749606223,
  exp: 1750211023
}
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔍 Notifications /unread-count - Buscando contagem para usuário ID: 58
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔍 Final do middleware - Usuário autenticado? true
Verificando autenticação na rota de assinatura...
✅ Usuário autenticado: lucas.canova@hotmail.com
🔍 Buscando assinatura atual para usuário lucas.canova@hotmail.com (ID: 58)
✅ Notifications /unread-count - Contagem: 1
✅ Assinatura encontrada: {
  subscription: {
    id: 1,
    userId: 58,
    planId: 10,
    status: 'active',
    startDate: 2025-06-08T23:10:30.449Z,
    endDate: 2026-06-08T23:10:30.449Z,
    paymentMethod: 'admin_grant',
    price: 23990,
    createdAt: 2025-06-08T23:10:30.449Z,
    updatedAt: 2025-06-08T23:10:30.449Z
  },
  plan: {
    id: 10,
    name: 'ultra_family',
    displayName: 'Ultra Familiar',
    price: 23990,
    emergencyConsultations: 'unlimited',
    specialistDiscount: 70,
    insuranceCoverage: true,
    features: [
      'Mesmos benefícios do Ultra para cada dependente',
      'Até 4 CPFs',
      'Teleconsultas de emergência ilimitadas',
      '70% de desconto com especialistas',
      'Prioridade máxima de agendamento',
      'Cobertura de seguro: R$ 500/dia de internação',
      'Todos os demais benefícios dos planos anteriores'
    ],
    isDefault: false,
    createdAt: 2025-05-20T02:56:59.709Z,
    updatedAt: 2025-05-20T02:56:59.709Z
  }
}
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
Buscando consultas próximas para usuário 58
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
Buscando claims para usuário 58
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔍 Notifications - Buscando notificações do usuário ID: 58
Encontradas 0 consultas próximas
Encontrados 0 claims
✅ Notifications - Notificações encontradas: 1
Session table checked/created successfully
[API] Total de serviços: 10
[API] Exemplo de serviço: {
  id: 3,
  name: 'Suplementos, perfumaria, ortopédicos e manipulados',
  serviceImage: 'Sem imagem',
  partner: 'Tem parceiro'
}
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
[API] Total de serviços: 10
[API] Exemplo de serviço: {
  id: 3,
  name: 'Suplementos, perfumaria, ortopédicos e manipulados',
  serviceImage: 'Sem imagem',
  partner: 'Tem parceiro'
}
1:15:32 PM [vite] http proxy error: /api/auth/test
Error: read ECONNRESET
    at TCP.onStreamRead (node:internal/stream_base_commons:218:20)
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
Logout realizado com sucesso - cookies removidos
🔐 JWT: Usuário lucas.canova@hotmail.com autenticado via cookie com plano ultra_family
=== ROTA /api/user INTERCEPTADA ===
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react-dom_client.js.map" is outside of Vite serving allow list.

- /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated

Refer to docs https://vite.dev/config/server-options.html#server-fs-allow for configurations and more details.

The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-WOOG5QLI.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react_jsx-dev-runtime.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-QCHXOAYK.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-KBTYAULA.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-E7TSFT4J.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-CQ7JXR62.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-J2KA7NLM.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-U64FLBTD.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/wouter.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-U27FYV5Z.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@tanstack_react-query.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-NZP5GMFF.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-GWFQETYR.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-KCFVMCIE.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-5Q5YC75F.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-NGYZDZO4.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-XZ6W2GS4.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-U7P2NEEE.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-toast.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-RPCDYKBN.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/class-variance-authority.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/clsx.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-VLXIV66X.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/tailwind-merge.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-4353NQWK.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-tooltip.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-YEAAHCP2.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-AAIF5F4B.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react-hook-form.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@hookform_resolvers_zod.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-slot.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-label.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-4RO2SXZU.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/zod.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-7V7HM4LB.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-tabs.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-6ZMM2PAV.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-43G6IMPT.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-avatar.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-HFOQCBDA.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-select.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/lucide-react.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-IIGUYIAY.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/date-fns.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-O42U6HQT.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/date-fns_locale.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-dropdown-menu.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-JZFGAL4V.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-IPKNSNOM.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-dialog.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-separator.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@daily-co_daily-js.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react-helmet.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-7RUGVAIV.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-radio-group.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-checkbox.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/chunk-VSYDWS32.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react-image-crop.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@stripe_stripe-js.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/axios.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/drizzle-orm.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/drizzle-orm_pg-core.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-switch.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-alert-dialog.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-scroll-area.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@radix-ui_react-accordion.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/@stripe_react-stripe-js.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/react-qr-code.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/recharts.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/framer-motion.js.map" is outside of Vite serving allow list.
The request url "/Users/lucascanova/Documents/CN Vidas - Domingo 08-06/CNVidas-updated/node_modules/.vite/deps/html5-qrcode.js.map" is outside of Vite serving allow list.
=== ROTA /api/user INTERCEPTADA ===
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'ndasinoda@nfasonda.com',
  username: 'CRMSP423423',
  password: '6666666',
  fullName: 'CMpoasdn CANDSP CAp',
  role: 'doctor',
  acceptTerms: true,
  acceptPrivacy: true
}
Usuário criado com sucesso: { id: 77, email: 'ndasinoda@nfasonda.com' }
Erro no registro: error: relation "legal_acceptances" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:189:5) {
  length: 116,
  severity: 'ERROR',
  code: '42P01',
  detail: undefined,
  hint: undefined,
  position: '13',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_relation.c',
  line: '1449',
  routine: 'parserOpenTable'
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testpatient1749659263743@example.com',
  username: 'testpatient1749659263743',
  password: 'Test123456!',
  fullName: 'Test Patient User',
  role: 'patient',
  acceptTerms: true,
  acceptPrivacy: true
}
Erro no registro: AppError: Você deve aceitar o Contrato de Adesão para pacientes
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:82:13)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:175:3)
    at router (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:47:12)
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:48:5)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at ensureJsonResponse (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/middleware/json-response.ts:40:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/index.ts:186:5)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at cookieParser (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/cookie-parser/index.js:57:14)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at urlencodedParser (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/body-parser/lib/types/urlencoded.js:85:7)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/body-parser/lib/read.js:137:5
    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
    at invokeCallback (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:238:16)
    at done (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:227:7)
    at IncomingMessage.onEnd (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:287:7)
    at IncomingMessage.emit (node:events:519:28)
    at endReadableNT (node:internal/streams/readable:1696:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  statusCode: 400,
  status: 'fail',
  isOperational: true
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testdoctor1749659264845@example.com',
  username: 'testdoctor1749659264845',
  password: 'Test123456!',
  fullName: 'Test Doctor User',
  role: 'doctor',
  acceptTerms: true,
  acceptPrivacy: true,
  licenseNumber: 'CRM1749659264845',
  specialization: 'Clínica Geral'
}
Usuário criado com sucesso: { id: 78, email: 'testdoctor1749659264845@example.com' }
Erro no registro: error: column "is_active" of relation "legal_acceptances" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:189:5) {
  length: 140,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '131',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testpartner1749659266519@example.com',
  username: 'testpartner1749659266519',
  password: 'Test123456!',
  fullName: 'Test Partner User',
  role: 'partner',
  acceptTerms: true,
  acceptPrivacy: true,
  businessName: 'Test Business 1749659266519',
  businessType: 'clinic'
}
Erro no registro: AppError: Você deve aceitar o Contrato de Parceria para empresas
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:86:13)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:175:3)
    at router (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:47:12)
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/index.ts:48:5)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:284:15
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at ensureJsonResponse (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/middleware/json-response.ts:40:3)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/index.ts:186:5)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at cookieParser (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/cookie-parser/index.js:57:14)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at urlencodedParser (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/body-parser/lib/types/urlencoded.js:85:7)
    at Layer.handle [as handle_request] (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:328:13)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/express/lib/router/index.js:280:10)
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/body-parser/lib/read.js:137:5
    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
    at invokeCallback (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:238:16)
    at done (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:227:7)
    at IncomingMessage.onEnd (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/raw-body/index.js:287:7)
    at IncomingMessage.emit (node:events:519:28)
    at endReadableNT (node:internal/streams/readable:1696:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:82:21) {
  statusCode: 400,
  status: 'fail',
  isOperational: true
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testpatient1749659310276@example.com',
  username: 'testpatient1749659310276',
  password: 'Test123456!',
  fullName: 'Test Patient User',
  role: 'patient',
  acceptTerms: true,
  acceptPrivacy: true,
  acceptContract: true,
  acceptPartnerContract: true
}
Usuário criado com sucesso: { id: 79, email: 'testpatient1749659310276@example.com' }
Erro no registro: error: column "is_active" of relation "legal_acceptances" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:189:5) {
  length: 140,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '131',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testdoctor1749659311949@example.com',
  username: 'testdoctor1749659311949',
  password: 'Test123456!',
  fullName: 'Test Doctor User',
  role: 'doctor',
  acceptTerms: true,
  acceptPrivacy: true,
  acceptContract: true,
  acceptPartnerContract: true,
  licenseNumber: 'CRM1749659311949',
  specialization: 'Clínica Geral'
}
Usuário criado com sucesso: { id: 80, email: 'testdoctor1749659311949@example.com' }
Erro no registro: error: column "is_active" of relation "legal_acceptances" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:189:5) {
  length: 140,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '131',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
=== ROTA /api/register INTERCEPTADA ===
Registro - dados recebidos: {
  email: 'testpartner1749659313314@example.com',
  username: 'testpartner1749659313314',
  password: 'Test123456!',
  fullName: 'Test Partner User',
  role: 'partner',
  acceptTerms: true,
  acceptPrivacy: true,
  acceptContract: true,
  acceptPartnerContract: true,
  businessName: 'Test Business 1749659313314',
  businessType: 'clinic'
}
Usuário criado com sucesso: { id: 81, email: 'testpartner1749659313314@example.com' }
Erro no registro: error: column "is_active" of relation "legal_acceptances" does not exist
    at /Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/node_modules/@neondatabase/serverless/index.js:1086:33
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/Users/lucascanova/Documents/CNVidas 1.0/CNVidas-updated/server/routes/auth-routes.ts:189:5) {
  length: 140,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '131',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
1:29:02 PM [vite] hmr update /src/components/forms/appointment-form.tsx, /src/index.css?v=yzuV57EyEc6NcuP9KQzSr
1:29:03 PM [tsx] change in ./shared/schema.ts Restarting...
cAuthRouter carregado - rotas disponíveis:
- POST /register
- POST /login
- POST /test
- GET /user (verificação de autenticação)
[33mThe CJS build of Vite's Node API is deprecated. See https://vite.dev/guide/troubleshooting.html#vite-cjs-node-api-deprecated for more details.[39m
Registrando authRouter em /api/auth
Registrando userRouter em /api/users
Registrando adminRoutes em /api/admin
Registrando partnerRouter em /api/partners
Registrando doctorRouter em /api/doctors
Registrando notificationRouter em /api/notifications
Registrando checkoutTrackingRouter em /api
Registrando rotas públicas de médicos em /api/doctors
Registrando rotas públicas de serviços em /api/services
Registrando legalDocumentsRouter em /api/legal-documents
Conexão com o banco de dados testada com sucesso: 2025-06-11 16:29:07.73816+00
Session table checked/created successfully
1:29:08 PM [server] Servidor rodando na porta 3000
Configuração de email carregada. Serviço de email disponível.
